#summary Принятый принцип определения размера раздела
#labels Phase-Design,Phase-Implementation

= Введение =

По скольку предполагается работа с битыми дисками без использования администраторских прав введены ограничения на используемые функции для определения размера исходного раздела:
 * Не используются ioctl и системные вызовы
 * Нет доверия mbr и загрузочному сектору раздела

= Решение =
  * По скольку допустима работа с образами разделов, в первую очередь используется функция определения длинны файла. Если она не доступна, то работа ведется с диском напрямую, и пробуется следующий метод.
  * Для определения размера раздела используется позиционирование по диску. За основу берется нулевая позиция, затем к ней циклически добавляются предполагаемые порции размера. Эти порции вычисляются в цикле второго уровня и принимают значение от 1<<48 до 1 в сторону уменьшения:
{{{
  int bits=48; 
  while (bits-- > 0) {
 	step = (quint64) 1 <<bits;	
	while ( this->file.seek(pozition+step) ) {
 	  pozition+=step;		
       }
  }
  size = position;
}}}
Результат 100% верен для файлов, и предположительно безошибочен для устройств. Тесты произведенные с доступными жесткими дисками и разделами подтверждают это предположение.